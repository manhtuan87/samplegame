<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Kids Mini Games ‚Äì 5 tr√≤ ch∆°i cho b√©</title>
  <style>
    :root{
      --bg:#f6f7fb; --card:#ffffff; --txt:#1f2937; --muted:#667185; --brand:#4f46e5; --ok:#16a34a; --warn:#eab308; --bad:#dc2626;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,Segoe UI,Roboto,Inter,Helvetica,Arial,sans-serif;background:var(--bg);color:var(--txt)}
    .wrap{max-width:960px;margin:0 auto;padding:18px}
    header{display:flex;gap:12px;align-items:center;justify-content:space-between;margin-bottom:14px}
    h1{font-size:clamp(22px,3vw,28px);margin:0}
    .controls{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
    select,button{border:1px solid #dfe3ea;background:#fff;padding:10px 14px;border-radius:12px;font-size:16px}
    button.primary{background:var(--brand);color:#fff;border-color:transparent}
    button.ghost{background:#fff}
    .grid{display:grid;gap:12px}
    .grid.cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}
    .grid.cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}
    .grid.cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}
    .card{background:var(--card);border:1px solid #e8ecf2;border-radius:16px;box-shadow:0 4px 16px rgba(0,0,0,.04)}
    .menu-item{padding:18px;display:flex;align-items:center;gap:12px;cursor:pointer;transition:transform .06s ease}
    .menu-item:active{transform:scale(.98)}
    .menu-emoji{font-size:28px}
    .menu-title{font-weight:700}
    .view{display:none}
    .view.active{display:block}
    .prompt{padding:14px 16px;font-size:18px;border-bottom:1px solid #eef1f6}
    .arena{position:relative;min-height:420px;height:60vh;overflow:hidden;border-top:1px solid #eef1f6;border-radius:0 0 16px 16px}
    .hud{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;padding:12px}
    .hud-item{background:#fafbff;border:1px solid #eef1f6;border-radius:12px;padding:12px;text-align:center}
    .hud-item .label{font-size:12px;color:var(--muted)}
    .hud-item .value{font-weight:700;font-size:20px}
    .center{display:flex;align-items:center;justify-content:center;text-align:center}
    .footer{margin-top:10px;color:var(--muted);font-size:13px}
    /* game 2 balloons */
    .balloon{position:absolute;display:flex;align-items:center;justify-content:center;width:96px;height:96px;border-radius:50%;color:#fff;font-weight:700;font-size:18px;user-select:none;cursor:pointer;box-shadow:0 6px 16px rgba(0,0,0,.12);transition:transform .08s ease}
    .balloon:active{transform:scale(.95)}
    .pop{animation:pop .25s ease forwards}
    @keyframes pop{to{transform:scale(1.25);opacity:0;filter:blur(2px)}}
    .balloon.fail{box-shadow:0 0 0 6px rgba(220,38,38,.35) inset; animation:shake .25s linear}
    @keyframes shake{0%,100%{transform:translateX(0)}20%{transform:translateX(-6px)}40%{transform:translateX(6px)}60%{transform:translateX(-4px)}80%{transform:translateX(4px)}}
    .float-minus{position:absolute;pointer-events:none;color:var(--bad);font-weight:800;font-size:28px;text-shadow:0 2px 8px rgba(0,0,0,.15);animation:rise .6s ease-out forwards}
    @keyframes rise{to{transform:translateY(-24px);opacity:0}}
    /* game 3 memory */
    .mm-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;padding:14px}
    .mm-card{width:70px;height:70px;background:#eee;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:32px;cursor:pointer;user-select:none;transition:background .3s}
    .mm-card.open,.mm-card.matched{background:var(--card);box-shadow:0 4px 10px rgba(0,0,0,.1)}
    .mm-card.matched{background:var(--ok);color:#fff}
    /* game 4 shapes */
    .shape{width:88px;height:88px;display:flex;align-items:center;justify-content:center;cursor:pointer}
    .shape.square{background:#94a3b8;border-radius:12px}
    .shape.circle{background:#60a5fa;border-radius:50%}
    .shape.triangle{width:0;height:0;border-left:44px solid transparent;border-right:44px solid transparent;border-bottom:88px solid #f59e0b}
    /* game 5 counting */
    .tap-item{font-size:40px;cursor:pointer;user-select:none}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>üë∂ Kids Mini Games</h1>
      <div class="controls">
        <select id="lang">
          <option value="vi">Ti·∫øng Vi·ªát</option>
          <option value="ja">Êó•Êú¨Ë™û</option>
        </select>
        <button class="ghost" id="homeBtn">üè† Menu</button>
      </div>
    </header>

    <!-- HOME MENU -->
    <div id="view-home" class="view active">
      <div class="grid cols-2">
        <div class="card menu-item" data-go="g1"><div class="menu-emoji">üê∂</div><div><div class="menu-title" data-i="g1">T√¨m ƒë√∫ng con v·∫≠t</div><div class="muted" style="color:var(--muted)">Ch·ªçn con v·∫≠t theo y√™u c·∫ßu</div></div></div>
        <div class="card menu-item" data-go="g2"><div class="menu-emoji">üéà</div><div><div class="menu-title" data-i="g2">Pop the Color</div><div class="muted" style="color:var(--muted)">B·∫•m bong b√≥ng ƒë√∫ng m√†u</div></div></div>
        <div class="card menu-item" data-go="g3"><div class="menu-emoji">üß©</div><div><div class="menu-title" data-i="g3">Memory Match</div><div class="muted" style="color:var(--muted)">L·∫≠t th·∫ª t√¨m c·∫∑p</div></div></div>
        <div class="card menu-item" data-go="g4"><div class="menu-emoji">üî∫</div><div><div class="menu-title" data-i="g4">Gh√©p H√¨nh</div><div class="muted" style="color:var(--muted)">Ch·ªçn h√¨nh ƒë√∫ng</div></div></div>
        <div class="card menu-item" data-go="g5"><div class="menu-emoji">‚≠ê</div><div><div class="menu-title" data-i="g5">ƒê·∫øm & Ch·∫°m</div><div class="muted" style="color:var(--muted)">Ch·∫°m ƒë√∫ng s·ªë l∆∞·ª£ng</div></div></div>
      </div>
      <div class="footer">Kh√¥ng qu·∫£ng c√°o ‚Ä¢ Ch·∫°y offline ‚Ä¢ T·ªëi ∆∞u cho smartphone</div>
    </div>

    <!-- GAME 1: FIND THE ANIMAL -->
    <div id="view-g1" class="view">
      <div class="card">
        <div class="prompt" id="g1-prompt">Ch·ªçn con <b>M√®o</b> nh√©!</div>
        <div class="hud">
          <div class="hud-item"><div class="label" id="g1-lblTarget">C·∫ßn t√¨m</div><div class="value" id="g1-target">M√®o</div></div>
          <div class="hud-item"><div class="label" id="g1-lblScore">ƒêi·ªÉm</div><div class="value" id="g1-score">0</div></div>
          <div class="hud-item"><div class="label" id="g1-lblTime">Th·ªùi gian</div><div class="value" id="g1-time">60</div></div>
          <div class="hud-item"><div class="label" id="g1-lblLevel">M·ª©c</div><div class="value" id="g1-level">1</div></div>
        </div>
        <div class="arena center" id="g1-arena" style="gap:16px;flex-wrap:wrap;padding:12px"></div>
        <div class="center" style="gap:8px;padding:12px">
          <button class="primary" id="g1-start">‚ñ∂ B·∫Øt ƒë·∫ßu</button>
          <select id="g1-speed">
            <option value="slow">Ch·∫≠m</option>
            <option value="normal" selected>B√¨nh th∆∞·ªùng</option>
            <option value="fast">Nhanh</option>
          </select>
        </div>
      </div>
    </div>

    <!-- GAME 2: POP THE COLOR (from earlier, with minus on wrong & speed + stop) -->
    <div id="view-g2" class="view">
      <div class="card">
        <div class="prompt" id="g2-prompt">H√£y b·∫•m v√†o b√≥ng m√†u <b>ƒê·ªè</b>!</div>
        <div class="hud">
          <div class="hud-item"><div class="label" id="g2-lblTarget">M√†u c·∫ßn b·∫•m</div><div class="value" id="g2-target">ƒê·ªè</div></div>
          <div class="hud-item"><div class="label" id="g2-lblScore">ƒêi·ªÉm</div><div class="value" id="g2-score">0</div></div>
          <div class="hud-item"><div class="label" id="g2-lblTime">Th·ªùi gian</div><div class="value" id="g2-time">60</div></div>
          <div class="hud-item"><div class="label" id="g2-lblLevel">M·ª©c</div><div class="value" id="g2-level">1</div></div>
        </div>
        <div class="arena" id="g2-arena"></div>
        <div class="center" style="gap:8px;padding:12px">
          <button class="primary" id="g2-toggle">‚ñ∂ B·∫Øt ƒë·∫ßu</button>
          <select id="g2-diff">
            <option value="easy">D·ªÖ</option>
            <option value="normal" selected>V·ª´a</option>
            <option value="hard">Kh√≥</option>
          </select>
          <select id="g2-speed">
            <option value="slow">Ch·∫≠m</option>
            <option value="normal" selected>B.th∆∞·ªùng</option>
            <option value="fast">Nhanh</option>
            <option value="turbo">R·∫•t nhanh</option>
          </select>
        </div>
      </div>
    </div>

    <!-- GAME 3: MEMORY MATCH -->
    <div id="view-g3" class="view">
      <div class="card">
        <div class="prompt" id="g3-prompt">L·∫≠t th·∫ª t√¨m c·∫∑p gi·ªëng nhau</div>
        <div class="center" style="gap:8px;padding:12px">
          <button class="primary" id="g3-start">‚ñ∂ B·∫Øt ƒë·∫ßu</button>
        </div>
        <div class="mm-grid" id="g3-grid"></div>
        <div class="center" style="padding:10px">ƒêi·ªÉm: <b id="g3-score">0</b></div>
      </div>
    </div>

    <!-- GAME 4: SHAPE MATCH -->
    <div id="view-g4" class="view">
      <div class="card">
        <div class="prompt" id="g4-prompt">Ch·ªçn h√¨nh: <b>Tr√≤n</b></div>
        <div class="center" style="gap:16px;flex-wrap:wrap;padding:16px" id="g4-arena"></div>
        <div class="center" style="gap:8px;padding:12px">
          <div>ƒêi·ªÉm: <b id="g4-score">0</b></div>
          <button class="primary" id="g4-next">C√¢u m·ªõi</button>
        </div>
      </div>
    </div>

    <!-- GAME 5: COUNT & TAP -->
    <div id="view-g5" class="view">
      <div class="card">
        <div class="prompt" id="g5-prompt">H√£y ch·∫°m ƒë√∫ng <b>3</b> ng√¥i sao ‚≠ê</div>
        <div class="center" id="g5-arena" style="gap:12px;flex-wrap:wrap;padding:14px"></div>
        <div class="center" style="gap:10px;padding:12px"><div>ƒêi·ªÉm: <b id="g5-score">0</b></div><button class="primary" id="g5-next">M·ªõi</button></div>
      </div>
    </div>

  </div>

  <script>
    // ===== i18n (vi + ja) =====
    const I = {
      vi:{ menu:{g1:'T√¨m ƒë√∫ng con v·∫≠t', g2:'Pop the Color', g3:'Memory Match', g4:'Gh√©p H√¨nh', g5:'ƒê·∫øm & Ch·∫°m'},
           g1:{prompt:a=>`Ch·ªçn con <b>${a}</b> nh√©!`, target:'C·∫ßn t√¨m', score:'ƒêi·ªÉm', time:'Th·ªùi gian', level:'M·ª©c'},
           g2:{prompt:c=>`H√£y b·∫•m v√†o b√≥ng m√†u <b>${c}</b>!`, start:'‚ñ∂ B·∫Øt ƒë·∫ßu', stop:'‚ñ† D·ª´ng', minus:'Sai s·∫Ω b·ªã tr·ª´ ƒëi·ªÉm (-1)'},
           g3:{prompt:'L·∫≠t th·∫ª t√¨m c·∫∑p gi·ªëng nhau', start:'‚ñ∂ B·∫Øt ƒë·∫ßu'},
           g4:{prompt:s=>`Ch·ªçn h√¨nh: <b>${s}</b>`, next:'C√¢u m·ªõi'},
           g5:{prompt:n=>`H√£y ch·∫°m ƒë√∫ng <b>${n}</b> ng√¥i sao ‚≠ê`, next:'M·ªõi'},
      },
      ja:{ menu:{g1:'„Å©„ÅÜ„Å∂„Å§„Åï„Åå„Åó', g2:'„Éù„ÉÉ„Éó„Éª„Ç∂„Éª„Ç´„É©„Éº', g3:'„É°„É¢„É™„Éº', g4:'„Åã„Åü„Å°„ÅÇ„Çè„Åõ', g5:'„Åã„Åö„Çø„ÉÉ„Éó'},
           g1:{prompt:a=>`<b>${a}</b> „Çí„Åà„Çâ„Çì„Åß„Å≠ÔºÅ`, target:'„Åï„Åå„Åô', score:'„Çπ„Ç≥„Ç¢', time:'„Åò„Åã„Çì', level:'„É¨„Éô„É´'},
           g2:{prompt:c=>`<b>${c}</b> „ÅÆ„Åµ„ÅÜ„Åõ„Çì„Çí„Çø„ÉÉ„ÉóÔºÅ`, start:'‚ñ∂ „Çπ„Çø„Éº„Éà', stop:'‚ñ† „Çπ„Éà„ÉÉ„Éó', minus:'„Åæ„Å°„Åå„Åà„Çã„Å® 1ÁÇπ„Éû„Ç§„Éä„Çπ'},
           g3:{prompt:'„Åä„Å™„Åò„Ç´„Éº„Éâ„Çí„ÅÇ„Å¶„Çà„ÅÜ', start:'‚ñ∂ „Çπ„Çø„Éº„Éà'},
           g4:{prompt:s=>`„Åã„Åü„Å°Ôºö<b>${s}</b>`, next:'„Å§„Åé'},
           g5:{prompt:n=>`‚≠ê „Çí <b>${n}</b> „Åì„Çø„ÉÉ„Éó„Åó„Å¶„Å≠`, next:'„ÅÇ„Åü„Çâ„Åó„ÅÑ'},
      }
    };

    const langSel = document.getElementById('lang');
    const homeBtn = document.getElementById('homeBtn');
    function show(id){ document.querySelectorAll('.view').forEach(v=>v.classList.remove('active')); document.getElementById('view-'+id).classList.add('active'); window.scrollTo({top:0,behavior:'smooth'});}    
    document.querySelectorAll('.menu-item').forEach(mi=>mi.addEventListener('click',()=>show(mi.dataset.go)));
    homeBtn.addEventListener('click',()=>show('home'));

    let LANG='vi';
    langSel.addEventListener('change',()=>{ LANG=langSel.value; applyLang(); });
    function textSel(){return I[LANG]}
    function applyLang(){
      document.querySelector('[data-i="g1"]').textContent = textSel().menu.g1;
      document.querySelector('[data-i="g2"]').textContent = textSel().menu.g2;
      document.querySelector('[data-i="g3"]').textContent = textSel().menu.g3;
      document.querySelector('[data-i="g4"]').textContent = textSel().menu.g4;
      document.querySelector('[data-i="g5"]').textContent = textSel().menu.g5;
      // update prompts dynamically when next round starts in each game.
      g1_updateHUD(); g2_updateHUD(); g3_setPrompt(); g4_setPrompt(); g5_setPrompt();
    }

    // ===== GAME 1: FIND THE ANIMAL =====
    const G1_ANIMALS = [
      {key:'Cat', vi:'M√®o', ja:'„Å≠„Åì', emoji:'üê±'},
      {key:'Dog', vi:'Ch√≥', ja:'„ÅÑ„Å¨', emoji:'üê∂'},
      {key:'Lion', vi:'S∆∞ t·ª≠', ja:'„É©„Ç§„Ç™„É≥', emoji:'ü¶Å'},
      {key:'Frog', vi:'·∫æch', ja:'„Åã„Åà„Çã', emoji:'üê∏'},
      {key:'Panda', vi:'G·∫•u tr√∫c', ja:'„Éë„É≥„ÉÄ', emoji:'üêº'},
      {key:'Monkey', vi:'Kh·ªâ', ja:'„Åï„Çã', emoji:'üêµ'},
      {key:'Pig', vi:'Heo', ja:'„Å∂„Åü', emoji:'üê∑'},
      {key:'Rabbit', vi:'Th·ªè', ja:'„ÅÜ„Åï„Åé', emoji:'üê∞'},
    ];
    let g1={running:false,score:0,time:60,level:1,target:0,timer:null};
    const g1_arena = document.getElementById('g1-arena');
    const g1_score = document.getElementById('g1-score');
    const g1_time = document.getElementById('g1-time');
    const g1_level = document.getElementById('g1-level');
    const g1_target = document.getElementById('g1-target');
    const g1_prompt = document.getElementById('g1-prompt');
    const g1_start = document.getElementById('g1-start');
    const g1_speed = document.getElementById('g1-speed');

    function g1_name(a){return a[LANG]}
    function g1_choose(){ g1.target = Math.floor(Math.random()*G1_ANIMALS.length); }
    function g1_updateHUD(){
      g1_score.textContent=g1.score; g1_time.textContent=g1.time; g1_level.textContent=g1.level; g1_target.textContent=g1_name(G1_ANIMALS[g1.target]);
      g1_prompt.innerHTML = textSel().g1.prompt(g1_name(G1_ANIMALS[g1.target]));
    }
    function g1_spawn(){
      g1_arena.innerHTML='';
      const arr=[...G1_ANIMALS];
      arr.sort(()=>Math.random()-0.5);
      arr.slice(0,8).forEach(a=>{
        const b=document.createElement('button');
        b.className='card'; b.style.width='110px'; b.style.height='110px'; b.style.fontSize='42px';
        b.innerHTML=`<div style="font-size:46px">${a.emoji}</div><div style="font-size:14px;color:var(--muted)">${g1_name(a)}</div>`;
        b.addEventListener('click',()=>{
          if(!g1.running) return;
          if(a.key===G1_ANIMALS[g1.target].key){ g1.score++; if(g1.score%6===0) g1.level++; g1_choose(); g1_spawn(); }
          else { g1.score = Math.max(0,g1.score-1); b.animate([{transform:'translateX(0)'},{transform:'translateX(-6px)'},{transform:'translateX(6px)'}],{duration:200}); }
          g1_updateHUD();
        });
        g1_arena.appendChild(b);
      });
    }
    function g1_startGame(){
      g1.running=true; g1.score=0; g1.time=60; g1.level=1; g1_choose(); g1_updateHUD(); g1_spawn();
      if(g1.timer) clearInterval(g1.timer);
      const factor = {slow:1, normal:1, fast:1}[g1_speed.value]; // speed placeholder for future use
      g1.timer = setInterval(()=>{ if(!g1.running) return; g1.time-=1; g1_time.textContent=g1.time; if(g1.time<=0){ g1_end(); } }, 1000/factor);
      g1_start.textContent='‚ñ† D·ª´ng';
    }
    function g1_end(){ g1.running=false; if(g1.timer) clearInterval(g1.timer); alert(`H·∫øt gi·ªù! ƒêi·ªÉm: ${g1.score}`); g1_start.textContent='‚ñ∂ B·∫Øt ƒë·∫ßu'; }
    g1_start.addEventListener('click',()=>{ if(g1.running) g1_end(); else g1_startGame(); });

    // ===== GAME 2: POP THE COLOR =====
    const G2_COLORS = [
      {key:'Red', vi:'ƒê·ªè', ja:'„ÅÇ„Åã', hex:'#ef4444'},
      {key:'Blue', vi:'Xanh d∆∞∆°ng', ja:'„ÅÇ„Åä', hex:'#3b82f6'},
      {key:'Green', vi:'Xanh l√°', ja:'„Åø„Å©„Çä', hex:'#22c55e'},
      {key:'Yellow', vi:'V√†ng', ja:'„Åç„ÅÑ„Çç', hex:'#eab308'},
      {key:'Purple', vi:'T√≠m', ja:'„ÇÄ„Çâ„Åï„Åç', hex:'#a855f7'},
      {key:'Orange', vi:'Cam', ja:'„Ç™„É¨„É≥„Ç∏', hex:'#f97316'},
    ];
    const g2_arena = document.getElementById('g2-arena');
    const g2_score = document.getElementById('g2-score');
    const g2_time = document.getElementById('g2-time');
    const g2_level = document.getElementById('g2-level');
    const g2_target = document.getElementById('g2-target');
    const g2_prompt = document.getElementById('g2-prompt');
    const g2_toggle = document.getElementById('g2-toggle');
    const g2_diff = document.getElementById('g2-diff');
    const g2_speed = document.getElementById('g2-speed');
    let g2={running:false,score:0,time:60,level:1,target:0,spawnId:null,tickId:null};
    function g2_name(c){return c[LANG]}
    function g2_choose(){ g2.target = Math.floor(Math.random()*G2_COLORS.length); }
    function g2_updateHUD(){ g2_score.textContent=g2.score; g2_time.textContent=g2.time; g2_level.textContent=g2.level; g2_target.textContent=g2_name(G2_COLORS[g2.target]); g2_prompt.innerHTML=textSel().g2.prompt(g2_name(G2_COLORS[g2.target])); g2_toggle.textContent = g2.running ? textSel().g2.stop : textSel().g2.start; }
    function g2_spawn(){
      const b=document.createElement('div'); b.className='balloon';
      const c=G2_COLORS[Math.floor(Math.random()*G2_COLORS.length)];
      b.style.background=c.hex; b.dataset.key=c.key; b.style.left=(Math.random()*(g2_arena.clientWidth-110)+10)+'px'; b.style.top=(Math.random()*(g2_arena.clientHeight-110)+10)+'px';
      b.addEventListener('click',(e)=>{
        if(!g2.running) return; const rect=g2_arena.getBoundingClientRect(); const x=e.clientX-rect.left, y=e.clientY-rect.top;
        if(c.key===G2_COLORS[g2.target].key){ b.classList.add('pop'); g2.score++; if(g2.score%8===0) g2.level++; if(g2.score%5===0) g2_choose(); setTimeout(()=>b.remove(),220); }
        else { g2.score=Math.max(0,g2.score-1); b.classList.add('fail'); const fx=document.createElement('div'); fx.className='float-minus'; fx.textContent='-1'; fx.style.left=(x-10)+'px'; fx.style.top=(y-24)+'px'; g2_arena.appendChild(fx); setTimeout(()=>fx.remove(),620); setTimeout(()=>b.remove(),260); }
        g2_updateHUD();
      });
      g2_arena.appendChild(b);
      const life=2500-g2.level*80; setTimeout(()=>{ if(b.isConnected){ b.classList.add('pop'); setTimeout(()=>b.remove(),220);} }, Math.max(900,life));
    }
    function g2_restartSpawner(){ if(g2.spawnId) clearInterval(g2.spawnId); const base={easy:900,normal:700,hard:520}[g2_diff.value]; const factor={slow:1.3,normal:1.0,fast:0.8,turbo:0.6}[g2_speed.value]; const iv=Math.max(280,Math.floor(base*factor)); g2.spawnId=setInterval(g2_spawn,iv); }
    function g2_start(){ g2.running=true; g2.score=0; g2.time=60; g2.level=1; g2_choose(); g2_arena.innerHTML=''; g2_updateHUD(); g2_restartSpawner(); if(g2.tickId) clearInterval(g2.tickId); g2.tickId=setInterval(()=>{ if(!g2.running) return; g2.time--; g2_time.textContent=g2.time; if(g2.time<=0) g2_end(); },1000); }
    function g2_end(){ if(!g2.running) return; g2.running=false; if(g2.spawnId) clearInterval(g2.spawnId); if(g2.tickId) clearInterval(g2.tickId); alert(`H·∫øt gi·ªù! ƒêi·ªÉm: ${g2.score}`); g2_updateHUD(); }
    g2_toggle.addEventListener('click',()=>{ if(g2.running) g2_end(); else g2_start(); });
    g2_speed.addEventListener('change',()=>{ if(g2.running) g2_restartSpawner(); });
    g2_diff.addEventListener('change',()=>{ if(g2.running) g2_restartSpawner(); });

    // ===== GAME 3: MEMORY MATCH =====
    const g3_grid=document.getElementById('g3-grid');
    const g3_start=document.getElementById('g3-start');
    const g3_score=document.getElementById('g3-score');
    const G3_EMOJIS=['üê∂','üê±','ü¶Å','üê∏','üêº','üêµ','üê∑','üê∞'];
    let g3={first:null,lock:false,score:0};
    function g3_setPrompt(){ document.getElementById('g3-prompt').textContent = textSel().g3.prompt; g3_start.textContent=textSel().g3.start; }
    function g3_shuffle(a){ for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]];} return a; }
    function g3_startGame(){ g3_grid.innerHTML=''; g3.score=0; g3_score.textContent='0'; g3.first=null; g3.lock=false; const cards=g3_shuffle([...G3_EMOJIS,...G3_EMOJIS]); cards.forEach(sym=>{ const c=document.createElement('div'); c.className='mm-card'; c.dataset.sym=sym; c.textContent='?'; c.addEventListener('click',()=>g3_flip(c)); g3_grid.appendChild(c); }); }
    function g3_flip(c){ if(g3.lock||c.classList.contains('open')||c.classList.contains('matched'))return; c.classList.add('open'); c.textContent=c.dataset.sym; if(!g3.first){ g3.first=c; } else { if(g3.first.dataset.sym===c.dataset.sym){ c.classList.add('matched'); g3.first.classList.add('matched'); g3.score++; g3_score.textContent=g3.score; g3.first=null; } else { g3.lock=true; setTimeout(()=>{ c.classList.remove('open'); c.textContent='?'; g3.first.classList.remove('open'); g3.first.textContent='?'; g3.first=null; g3.lock=false; },800); } } }
    g3_start.addEventListener('click',g3_startGame);

    // ===== GAME 4: SHAPE MATCH =====
    const g4_arena=document.getElementById('g4-arena'); const g4_score=document.getElementById('g4-score'); const g4_next=document.getElementById('g4-next');
    const G4_SHAPES=[{k:'Tr√≤n',ja:'„Åæ„Çã',cls:'circle'},{k:'Vu√¥ng',ja:'„Åó„Åã„Åè',cls:'square'},{k:'Tam gi√°c',ja:'„Åï„Çì„Åã„Åè',cls:'triangle'}];
    let g4={score:0,target:0};
    function g4_label(s){return LANG==='vi'?s.k:s.ja}
    function g4_setPrompt(){ document.getElementById('g4-prompt').innerHTML = textSel().g4.prompt(g4_label(G4_SHAPES[g4.target]||G4_SHAPES[0])); }
    function g4_newRound(){ g4_arena.innerHTML=''; g4.target=Math.floor(Math.random()*G4_SHAPES.length); g4_setPrompt(); const arr=[...G4_SHAPES]; arr.sort(()=>Math.random()-0.5); arr.forEach(s=>{ const div=document.createElement('div'); div.className='shape '+s.cls; div.title=g4_label(s); div.addEventListener('click',()=>{ if(s.cls===G4_SHAPES[g4.target].cls){ g4.score++; g4_score.textContent=g4.score; g4_newRound(); } else { div.animate([{transform:'translateX(0)'},{transform:'translateX(-6px)'},{transform:'translateX(6px)'}],{duration:200}); if(g4.score>0){ g4.score--; g4_score.textContent=g4.score; } } }); g4_arena.appendChild(div); }); }
    g4_next.addEventListener('click',g4_newRound);

    // ===== GAME 5: COUNT & TAP =====
    const g5_arena=document.getElementById('g5-arena'); const g5_score=document.getElementById('g5-score'); const g5_next=document.getElementById('g5-next'); const g5_prompt=document.getElementById('g5-prompt');
    let g5={need:3,hit:0,score:0};
    function g5_setPrompt(){ g5_prompt.innerHTML = textSel().g5.prompt(g5.need); g5_next.textContent=textSel().g5.next; }
    function g5_new(){ g5_arena.innerHTML=''; g5.need = Math.floor(Math.random()*3)+2; g5.hit=0; g5_setPrompt(); const items = Array.from({length:8}, (_,i)=>({sym: i%2===0?'‚≠ê':'üåô', good: i%3===0 })); items.sort(()=>Math.random()-0.5); items.forEach(it=>{ const s=document.createElement('div'); s.className='tap-item'; s.textContent= it.good?'‚≠ê':'üåô'; s.addEventListener('click',()=>{ if(it.good){ if(s.style.opacity==='0.4') return; s.style.opacity='0.4'; g5.hit++; if(g5.hit===g5.need){ g5.score++; g5_score.textContent=g5.score; setTimeout(g5_new,400); } } else { s.animate([{transform:'scale(1)'},{transform:'scale(0.9)'},{transform:'scale(1)'}],{duration:160}); if(g5.score>0){ g5.score--; g5_score.textContent=g5.score; } } }); g5_arena.appendChild(s); }); }
    g5_next.addEventListener('click',g5_new);

    // Initial
    applyLang();
    show('home');
  </script>
</body>
</html>